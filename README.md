# 网络主机扫描软件 (Network Host Scanner)

## 📖 项目简介
这是一个基于 Python 开发的网络主机存活扫描工具，支持图形界面 (GUI) 和命令行 (CLI) 两种操作模式。它能够快速扫描局域网或指定网段内的在线主机，并获取其 IP 地址、MAC 地址、主机名、响应时间及操作系统类型推测。

**作者信息：**
*   **作者**：张夏灵
*   **班级**：网云2302
*   **学号**：542307280233

## ✨ 功能特点
*   **双模式支持**：提供易用的图形界面 (Tkinter) 和高效的命令行接口。
*   **多线程扫描**：支持自定义线程数，实现快速并发扫描。
*   **灵活的目标指定**：
    *   单个 IP (e.g., `192.168.1.1`)
    *   IP 范围 (e.g., `192.168.1.1-100`)
    *   CIDR 网段 (e.g., `192.168.1.0/24`)
    *   自动检测本地网络
*   **丰富的信息获取**：IP、在线状态、MAC 地址 (需管理员权限)、主机名、响应时间。
*   **结果导出**：支持导出为 CSV, JSON, TXT, Excel 格式。
*   **实时反馈**：GUI 界面提供实时进度条、日志显示和统计信息。

## 🛠️ 环境要求与安装
1.  **Python 版本**：Python 3.6+
2.  **依赖安装**：
    ```bash
    pip install -r requirements.txt
    ```
    *主要依赖：`pandas`, `openpyxl` (用于Excel导出), `pillow` (用于图标生成)*

## 🚀 使用指南

### 1. 启动方式
可以直接运行 `main.py` 启动程序：
```bash
# 默认启动 (显示菜单)
python main.py

# 直接启动图形界面
python main.py gui

# 直接启动命令行模式
python main.py cli 192.168.1.1-254
```

### 2. 图形界面 (GUI)
*   运行程序后选择 "图形界面模式"。
*   在 "目标输入" 框中输入扫描范围，或点击 "快速扫描当前网络"。
*   调整 "线程数" 和 "超时时间" (可选)。
*   点击 "开始扫描"。
*   扫描完成后，可点击右侧按钮导出结果。

### 3. 命令行 (CLI)
```bash
# 扫描指定网段，使用 200 个线程
python main.py cli 192.168.1.0/24 -t 200

# 扫描并导出结果为 CSV
python main.py cli 192.168.1.1-100 -o result.csv --format csv
```

## 📦 打包构建
本项目包含自动打包脚本 `build.py`，可将程序打包为独立的可执行文件 (.exe)。

```bash
python build.py
```
运行脚本后，根据提示选择打包选项 (Windows/Linux)。打包后的文件将位于 `dist/` 目录下。

## ⚠️ 注意事项
1.  **权限说明**：获取 MAC 地址通常需要管理员 (Windows) 或 Root (Linux) 权限。建议以管理员身份运行程序。
2.  **防火墙**：扫描大量 IP 可能会被防火墙或安全软件拦截，请确保在授权的网络环境中通过。

## 📂 项目结构
*   `src/`: 源代码目录 (scanner, gui, cli, utils)
*   `main.py`: 程序入口
*   `build.py`: 打包脚本
*   `requirements.txt`: 项目依赖
*   `README.md`: 项目说明文档
